<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Undangan Pernikahan Mewah</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Great+Vibes&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- THEME CONFIG: BLACK & GOLD --- */
        body {
            font-family: 'Lato', sans-serif;
            background-color: #050505;
            color: #e5e5e5;
            overflow-x: hidden;
            position: relative;
        }

        /* Canvas untuk Animasi Partikel Emas */
        #canvas-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* Typography */
        .font-cali { font-family: 'Great Vibes', cursive; }
        .font-serif-title { font-family: 'Cinzel', serif; }

        /* Gold Gradient Text & Elements */
        .text-gold {
            background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0px 2px 10px rgba(212, 175, 55, 0.3);
        }
        
        .text-gold-flat { color: #d4af37; }
        .border-gold { border-color: #d4af37; }
        .bg-gold-gradient { background: linear-gradient(135deg, #d4af37 0%, #aa771c 100%); }

        /* Glassmorphism */
        .glass-card {
            background: rgba(20, 20, 20, 0.75);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8), inset 0 0 20px rgba(212, 175, 55, 0.05);
        }

        /* Countdown Boxes */
        .countdown-box {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(212, 175, 55, 0.4);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .countdown-box::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            50%, 100% { left: 100%; }
        }

        /* Animations */
        .fade-in-up { 
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 1s ease-out, transform 1s ease-out;
        }
        .fade-in-up.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Photo Frame */
        .photo-frame {
            border: 2px solid rgba(212, 175, 55, 0.3);
            padding: 5px;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
            transform: rotate(-2deg);
            transition: transform 0.3s;
        }
        .photo-frame:nth-child(even) {
            transform: rotate(2deg);
        }
        .photo-frame:hover {
            transform: rotate(0deg) scale(1.02);
            border-color: #d4af37;
            z-index: 10;
        }

        /* Input Styles */
        .custom-input {
            background: rgba(255, 255, 255, 0.1) !important;
            color: #fff !important;
            border: 1px solid #444 !important;
        }
        .custom-input:focus {
            border-color: #d4af37 !important;
            box-shadow: 0 0 5px rgba(212, 175, 55, 0.5) !important;
        }

        /* Modal Styles */
        .modal-overlay {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 gap-8">

    <!-- Animasi Latar Belakang -->
    <canvas id="canvas-bg"></canvas>

    <!-- SLIDE 1: HOME (Simple Names) -->
    <section class="w-full max-w-md fade-in-up visible">
        <div class="glass-card rounded-3xl p-8 relative text-center border-t-2 border-b-2 border-gold">
            
            <!-- Header -->
            <div class="mt-2 mb-6 relative z-10">
                <p class="uppercase tracking-[0.4em] text-[10px] text-gray-400 mb-4 font-serif-title">The Wedding Celebration</p>
                <h1 id="coupleNameDisplay" class="font-cali text-6xl md:text-7xl text-gold mb-4 py-2 leading-tight drop-shadow-lg">
                    Irvan & Warda
                </h1>
            </div>

            <!-- Divider Elegant -->
            <div class="flex items-center justify-center gap-4 mb-6 opacity-70">
                <div class="h-[1px] w-16 bg-gradient-to-r from-transparent via-[#d4af37] to-transparent"></div>
                <div class="w-2 h-2 rounded-full bg-[#d4af37] shadow-[0_0_10px_#d4af37]"></div>
                <div class="h-[1px] w-16 bg-gradient-to-r from-transparent via-[#d4af37] to-transparent"></div>
            </div>

            <!-- Guest Name -->
            <div id="guestContainer" class="mb-8 border-b border-gray-700 pb-6">
                <p class="text-[10px] text-gray-400 uppercase tracking-widest mb-2">Kepada Yth. Bapak/Ibu/Saudara/i</p>
                <h2 id="guestNameDisplay" class="font-serif-title text-xl text-[#d4af37] font-bold tracking-wide mb-3 animate-pulse">
                    Tamu Undangan
                </h2>
                <p class="text-sm text-gray-300 italic font-light leading-relaxed px-2">
                    "Mohon maaf apabila terdapat kesalahan penulisan nama/gelar"
                </p>
            </div>

            <!-- KETERANGAN COUNTDOWN -->
            <div class="mb-6 relative z-10">
                <div class="inline-block px-6 py-2 border-t border-b border-[#d4af37] border-opacity-30">
                    <p class="text-[10px] text-gray-400 uppercase tracking-widest mb-1">Insya Allah</p>
                    <p class="text-sm text-[#f0e6d2] tracking-wide font-serif-title">Menuju Hari Bahagia</p>
                </div>
            </div>

            <!-- Countdown -->
            <div id="countdownContainer" class="grid grid-cols-4 gap-3 mb-8 relative z-10">
                <div class="countdown-box p-3 flex flex-col justify-center items-center">
                    <span id="days" class="text-3xl font-serif-title text-gold-flat font-bold">00</span>
                    <span class="text-[9px] uppercase tracking-widest text-gray-400 mt-1">Hari</span>
                </div>
                <div class="countdown-box p-3 flex flex-col justify-center items-center">
                    <span id="hours" class="text-3xl font-serif-title text-gold-flat font-bold">00</span>
                    <span class="text-[9px] uppercase tracking-widest text-gray-400 mt-1">Jam</span>
                </div>
                <div class="countdown-box p-3 flex flex-col justify-center items-center">
                    <span id="minutes" class="text-3xl font-serif-title text-gold-flat font-bold">00</span>
                    <span class="text-[9px] uppercase tracking-widest text-gray-400 mt-1">Menit</span>
                </div>
                <div class="countdown-box p-3 flex flex-col justify-center items-center">
                    <span id="seconds" class="text-3xl font-serif-title text-gold-flat font-bold">00</span>
                    <span class="text-[9px] uppercase tracking-widest text-gray-400 mt-1">Detik</span>
                </div>
            </div>
            
            <div class="animate-bounce mt-4">
                <i class="fa-solid fa-chevron-down text-[#d4af37]"></i>
            </div>
        </div>
    </section>

    <!-- SLIDE 2: THE BRIDE & GROOM (DETAILED) -->
    <section class="w-full max-w-md fade-in-up">
        <div class="glass-card rounded-3xl p-8 relative text-center border-t-2 border-b-2 border-gold">
            
            <!-- Bismillah -->
            <p class="font-cali text-2xl text-[#d4af37] mb-4 opacity-80">Bismillahirrahmanirrahim</p>
            <p class="text-xs text-gray-300 italic mb-8 px-2 leading-relaxed">
                "Dengan memohon Rahmat dan Ridho Allah SWT, kami bermaksud menyelenggarakan pernikahan putra-putri kami:"
            </p>

            <!-- GROOM -->
            <div class="mb-6 relative">
                <h1 class="font-cali text-4xl text-gold mb-2 drop-shadow-md">Irvan Maulana</h1>
                <div class="flex flex-col items-center gap-1">
                    <div class="h-[1px] w-20 bg-[#d4af37] opacity-50 mb-1"></div>
                    <p class="text-[11px] text-gray-400 font-serif-title tracking-widest uppercase">Putra dari</p>
                    <p class="text-sm text-gray-200 font-bold">Bapak Samsi & Ibu Aniwati</p>
                </div>
            </div>

            <!-- AMPERSAND -->
            <div class="font-cali text-4xl text-[#d4af37] opacity-70 my-6 animate-pulse">&</div>

            <!-- BRIDE -->
            <div class="mb-6 relative">
                <h1 class="font-cali text-4xl text-gold mb-2 drop-shadow-md">Ananda Wardana Rohma</h1>
                <div class="flex flex-col items-center gap-1">
                    <div class="h-[1px] w-20 bg-[#d4af37] opacity-50 mb-1"></div>
                    <p class="text-[11px] text-gray-400 font-serif-title tracking-widest uppercase">Putri dari</p>
                    <p class="text-sm text-gray-200 font-bold">Bapak Eko Kusnanto & Ibu Riyanti</p>
                </div>
            </div>

        </div>
    </section>

    <!-- SLIDE 3: GALLERY & QUOTES -->
    <section class="w-full max-w-md fade-in-up">
        <div class="glass-card rounded-3xl p-8 relative text-center border-t-2 border-b-2 border-gold">
            
            <h2 class="font-cali text-4xl text-gold mb-6">Momen Bahagia</h2>
            
            <!-- Ayat Suci -->
            <div class="mb-8">
                <i class="fa-solid fa-quran text-[#d4af37] text-2xl mb-3 opacity-80"></i>
                <p class="text-xs text-gray-300 italic leading-relaxed font-light">
                    "Dan di antara tanda-tanda kekuasaan-Nya ialah Dia menciptakan untukmu isteri-isteri dari jenismu sendiri, supaya kamu cenderung dan merasa tenteram kepadanya, dan dijadikan-Nya diantaramu rasa kasih dan sayang."
                </p>
                <p class="text-[10px] text-[#d4af37] mt-2 font-serif-title uppercase tracking-widest">— Ar-Rum: 21 —</p>
            </div>

            <!-- Photo Grid -->
            <!-- PERHATIAN: Upload foto Anda ke GitHub.
                 Jika ada foto format .HEIC, ubah dulu ke .JPG agar bisa tampil! -->
            <div class="grid grid-cols-2 gap-3 mb-6">
                <div class="photo-frame">
                    <img src="1000106287.jpg" class="w-full h-40 object-cover rounded-sm filter sepia-[.2]" onerror="this.src='https://placehold.co/300x400/222/d4af37?text=Foto+1'">
                </div>
                <div class="photo-frame">
                    <!-- CATATAN: Format .HEIC tidak disupport browser. Ubah ke JPG/PNG lalu upload ulang & ganti nama file di sini -->
                    <img src="1000098098.heic" class="w-full h-40 object-cover rounded-sm filter sepia-[.2]" onerror="this.src='https://placehold.co/300x400/222/d4af37?text=Ganti+.HEIC+ke+.JPG'">
                </div>
                <div class="col-span-2 photo-frame">
                    <img src="1000073489.jpg" class="w-full h-48 object-cover rounded-sm filter sepia-[.2]" onerror="this.src='https://placehold.co/600x300/222/d4af37?text=Foto+Utama'">
                </div>
            </div>
        </div>
    </section>

    <!-- SLIDE 4: LOCATION & CLOSING -->
    <section class="w-full max-w-md fade-in-up pb-10">
        <div class="glass-card rounded-3xl p-8 relative text-center border-t-2 border-b-2 border-gold">
            
            <h2 class="font-cali text-4xl text-gold mb-6">Lokasi & Waktu</h2>

            <!-- Detail Acara -->
            <div class="space-y-4 mb-8">
                <div>
                    <i class="fa-regular fa-calendar text-[#d4af37] text-xl mb-2"></i>
                    <p class="font-serif-title text-sm text-white">Rabu, 31 Desember 2025</p>
                    <p class="text-xs text-gray-400">Pukul 09:00 WIB - Selesai</p>
                </div>
                
                <div class="border-t border-gray-700 pt-4 w-3/4 mx-auto"></div>

                <div>
                    <i class="fa-solid fa-location-dot text-[#d4af37] text-xl mb-2"></i>
                    <p class="uppercase tracking-widest text-[10px] text-gray-400 font-bold">Bertempat di</p>
                    <p class="font-serif-title text-sm text-white mt-1">Belakang SMK PGRI BANYUPUTIH</p>
                    <p class="text-[10px] text-gray-500 mt-1 italic">(Kediaman Mempelai Wanita)</p>
                </div>

                <!-- Tombol Maps -->
                <a href="https://www.google.com/maps/search/?api=1&query=-7.928461,114.406988" target="_blank" class="inline-block mt-2 px-6 py-3 bg-gray-800 border border-[#d4af37] rounded-full text-[#d4af37] text-xs font-bold hover:bg-[#d4af37] hover:text-black transition shadow-[0_0_15px_rgba(212,175,55,0.2)]">
                    <i class="fa-solid fa-map-location-dot mr-2"></i> Buka Google Maps
                </a>
            </div>

            <!-- Salam Penutup -->
            <div class="mb-8 mt-8">
                <p class="text-sm text-gray-300 italic font-light leading-relaxed">
                    "Merupakan suatu kehormatan dan kebahagiaan bagi kami apabila Bapak/Ibu/Saudara/i berkenan hadir untuk memberikan doa restu kepada kami."
                </p>
                <p class="font-cali text-3xl text-gold mt-6">Wassalamualaikum Wr. Wb.</p>
                <p class="text-xs text-gray-500 mt-2 uppercase tracking-widest">Kami yang berbahagia</p>
                <p class="font-serif-title text-lg text-white mt-1 font-bold">Irvan & Warda</p>
            </div>

            <!-- Action Buttons -->
            <div id="shareSection" class="flex flex-col gap-3 relative z-10 mb-6">
                <button onclick="openRSVPModal()" class="group w-full py-3 bg-gold-gradient text-black rounded-lg hover:brightness-110 transition-all duration-300 flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(212,175,55,0.4)] font-serif-title font-bold text-sm tracking-wide">
                    <i class="fa-brands fa-whatsapp text-lg group-hover:scale-110 transition"></i> Konfirmasi Kehadiran
                </button>
            </div>

            <!-- Generator (Admin Only - Tetap ada di paling bawah) -->
            <div id="adminPanel" class="hidden pt-5 border-t border-gray-800 mt-4">
                <button onclick="toggleGenerator()" class="flex items-center justify-between w-full text-gray-500 hover:text-[#d4af37] transition text-xs uppercase tracking-widest mb-2">
                    <span><i class="fa-solid fa-link mr-2"></i>Buat Link Untuk Tamu</span>
                    <i id="chevronIcon" class="fa-solid fa-chevron-down"></i>
                </button>
                
                <div id="generatorContent" class="hidden mt-3 transition-all">
                    <div id="localWarning" class="hidden mb-3 p-3 bg-red-900 bg-opacity-40 border border-red-700 rounded-md text-left">
                        <p class="text-xs text-red-200 font-bold mb-1"><i class="fa-solid fa-triangle-exclamation mr-1"></i> Perhatian:</p>
                        <p class="text-[10px] text-gray-300 leading-relaxed">
                            Upload ke hosting agar link berfungsi.
                        </p>
                    </div>
                    <div class="flex flex-col gap-2">
                        <input type="text" id="inputGuestName" placeholder="Ketik Nama Tamu" class="custom-input w-full px-4 py-2 rounded-md text-sm focus:outline-none">
                        <button onclick="generateAndCopyLink()" class="w-full py-2 bg-gray-800 border border-gray-600 text-gray-300 rounded-md hover:border-[#d4af37] hover:text-[#d4af37] transition text-xs font-bold uppercase tracking-wider">
                            <i class="fa-regular fa-copy mr-1"></i> Salin Link
                        </button>
                    </div>
                </div>
            </div>
            
            <p class="text-[8px] text-gray-700 mt-6">Digital Invitation</p>

        </div>
    </section>

    <!-- RSVP Modal -->
    <div id="rsvpModal" class="fixed inset-0 z-50 flex items-center justify-center modal-overlay hidden px-4">
        <div class="glass-card w-full max-w-sm rounded-2xl p-6 relative border border-gold transform scale-95 transition-transform duration-200">
            <button onclick="closeRSVPModal()" class="absolute top-3 right-3 text-gray-400 hover:text-white">
                <i class="fa-solid fa-times text-xl"></i>
            </button>
            <h3 class="font-serif-title text-[#d4af37] text-lg mb-2 font-bold text-center">RSVP</h3>
            <p class="text-xs text-gray-400 text-center mb-6">Hubungi kami untuk konfirmasi kehadiran:</p>
            <div class="space-y-3">
                <button onclick="sendWA('6287745756269', 'Irvan')" class="w-full py-3 bg-[#25D366] hover:bg-[#128C7E] text-white rounded-lg flex items-center justify-center gap-2 font-bold transition text-sm">
                    <i class="fa-brands fa-whatsapp text-lg"></i> Irvan (+62 877-4575-6269)
                </button>
                <button onclick="sendWA('62895326354065', 'Warda')" class="w-full py-3 bg-transparent border border-[#25D366] text-[#25D366] hover:bg-[#25D366] hover:text-white rounded-lg flex items-center justify-center gap-2 font-bold transition text-sm">
                    <i class="fa-brands fa-whatsapp text-lg"></i> Warda (+62 895-3263-54065)
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-10 left-1/2 transform -translate-x-1/2 bg-[#d4af37] text-black font-bold px-6 py-3 rounded-full shadow-[0_0_20px_rgba(212,175,55,0.5)] opacity-0 transition-all duration-500 pointer-events-none z-50 text-sm translate-y-[-20px]">
        Link tersalin!
    </div>

    <script>
        // --- ANIMATION CANVAS ---
        const canvas = document.getElementById('canvas-bg');
        const ctx = canvas.getContext('2d');
        let particlesArray;

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2; 
                this.speedX = (Math.random() * 1) - 0.5;
                this.speedY = (Math.random() * 1) - 0.5;
                this.color = Math.random() > 0.5 ? '#d4af37' : '#fcf6ba';
                this.opacity = Math.random() * 0.5 + 0.1;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.size > 0.2) this.size -= 0.005;
                if (this.size <= 0.2) this.size = Math.random() * 2.5;
                if (this.x > canvas.width) this.x = 0;
                if (this.x < 0) this.x = canvas.width;
                if (this.y > canvas.height) this.y = 0;
                if (this.y < 0) this.y = canvas.height;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.opacity;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function initParticles() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 9000;
            for (let i = 0; i < numberOfParticles; i++) {
                particlesArray.push(new Particle());
            }
        }

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particlesArray.length; i++) {
                particlesArray[i].update();
                particlesArray[i].draw();
            }
            requestAnimationFrame(animateParticles);
        }

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            initParticles();
        });

        // --- SCROLL ANIMATION ---
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    observer.unobserve(entry.target); 
                }
            });
        }, observerOptions);

        document.querySelectorAll('.fade-in-up').forEach(section => {
            observer.observe(section);
        });


        // --- APP LOGIC ---
        const getQueryParam = (param) => {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        };

        const defaultDateStr = "2025-12-31T09:00";
        const defaultNames = "Irvan & Warda";

        let targetDate = new Date(defaultDateStr);
        let coupleNames = defaultNames;
        let guestName = "Tamu Undangan"; 
        let countdownInterval;

        const els = {
            coupleNameDisplay: document.getElementById('coupleNameDisplay'),
            guestNameDisplay: document.getElementById('guestNameDisplay'),
            days: document.getElementById('days'),
            hours: document.getElementById('hours'),
            minutes: document.getElementById('minutes'),
            seconds: document.getElementById('seconds'),
            toast: document.getElementById('toast'),
            rsvpModal: document.getElementById('rsvpModal'),
            generatorContent: document.getElementById('generatorContent'),
            chevronIcon: document.getElementById('chevronIcon'),
            inputGuestName: document.getElementById('inputGuestName'),
            localWarning: document.getElementById('localWarning'),
            adminPanel: document.getElementById('adminPanel')
        };

        function initApp() {
            initParticles();
            animateParticles();

            if (window.location.protocol === 'file:') {
                els.localWarning.classList.remove('hidden');
            }

            if (getQueryParam('admin')) {
                els.adminPanel.classList.remove('hidden');
                toggleGenerator();
            }

            const paramDate = getQueryParam('target');
            const paramNames = getQueryParam('names');
            const paramGuest = getQueryParam('guest'); 

            if (paramDate) targetDate = new Date(paramDate);
            if (paramNames) coupleNames = decodeURIComponent(paramNames);
            if (paramGuest) guestName = decodeURIComponent(paramGuest);
            
            els.guestNameDisplay.innerText = guestName;
            
            // Mengembalikan logika nama couple jika di URL ada perubahan, 
            // tapi defaultnya tetap Irvan & Warda di HTML
            if(paramNames) {
                 els.coupleNameDisplay.innerText = coupleNames;
            }

            startCountdown();
        }

        function startCountdown() {
            if (countdownInterval) clearInterval(countdownInterval);

            function updateTimer() {
                const now = new Date().getTime();
                const distance = targetDate.getTime() - now;

                if (distance < 0) {
                    clearInterval(countdownInterval);
                    document.getElementById('countdownContainer').innerHTML = `
                        <div class="col-span-4 p-4 text-center rounded-lg border border-[#d4af37] bg-[#d4af37] bg-opacity-20">
                            <p class="text-[#d4af37] font-bold font-serif-title animate-pulse">Acara Sedang Berlangsung</p>
                        </div>
                    `;
                    return;
                }

                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                els.days.innerText = String(days).padStart(2, '0');
                els.hours.innerText = String(hours).padStart(2, '0');
                els.minutes.innerText = String(minutes).padStart(2, '0');
                els.seconds.innerText = String(seconds).padStart(2, '0');
            }

            updateTimer();
            countdownInterval = setInterval(updateTimer, 1000);
        }

        function toggleGenerator() {
            els.generatorContent.classList.toggle('hidden');
            if (els.generatorContent.classList.contains('hidden')) {
                els.chevronIcon.classList.remove('fa-chevron-up');
                els.chevronIcon.classList.add('fa-chevron-down');
            } else {
                els.chevronIcon.classList.remove('fa-chevron-down');
                els.chevronIcon.classList.add('fa-chevron-up');
            }
        }

        function generateAndCopyLink() {
            const newGuestName = els.inputGuestName.value.trim();
            if (!newGuestName) {
                showToast("Masukkan nama tamu dulu!");
                return;
            }

            const baseUrl = window.location.href.split('?')[0];
            let dateParam = defaultDateStr;
            if(getQueryParam('target')) dateParam = getQueryParam('target');
            
            const fullUrl = `${baseUrl}?target=${dateParam}&names=${encodeURIComponent(coupleNames)}&guest=${encodeURIComponent(newGuestName)}`;
            
            const textArea = document.createElement("textarea");
            textArea.value = fullUrl;
            textArea.style.position = "fixed"; 
            textArea.style.left = "-9999px";
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                if (window.location.protocol === 'file:') {
                     showToast("Link disalin (PERHATIAN: Upload ke hosting dulu!)");
                } else {
                     showToast("Link untuk " + newGuestName + " tersalin!");
                }
                els.inputGuestName.value = '';
            } catch (err) {
                showToast("Gagal menyalin otomatis.");
            }
            document.body.removeChild(textArea);
        }

        function openRSVPModal() {
            els.rsvpModal.classList.remove('hidden');
        }

        function closeRSVPModal() {
            els.rsvpModal.classList.add('hidden');
        }

        function sendWA(number, adminName) {
            let message = `Halo ${adminName}, saya ingin konfirmasi kehadiran di pernikahan ${coupleNames}.`;
            if (guestName && guestName !== "Tamu Undangan") {
                message = `Halo ${adminName}, saya *${guestName}* ingin konfirmasi kehadiran di pernikahan ${coupleNames}.`;
            }
            const waUrl = `https://wa.me/${number}?text=${encodeURIComponent(message)}`;
            window.open(waUrl, '_blank');
            closeRSVPModal();
        }

        function showToast(msg) {
            els.toast.innerText = msg;
            els.toast.classList.remove('opacity-0', 'translate-y-[-20px]');
            els.toast.classList.add('opacity-100', 'translate-y-0');
            setTimeout(() => {
                els.toast.classList.remove('opacity-100', 'translate-y-0');
                els.toast.classList.add('opacity-0', 'translate-y-[-20px]');
            }, 4000);
        }

        els.rsvpModal.addEventListener('click', (e) => {
            if (e.target === els.rsvpModal) closeRSVPModal();
        });

        window.onload = initApp;

    </script>
</body>
</html>


